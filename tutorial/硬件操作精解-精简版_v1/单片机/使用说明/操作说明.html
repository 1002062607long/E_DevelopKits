<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=Edit-Time-Data href="操作说明.files/editdata.mso">
<title>单片机串口通讯制作说明</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chmetcnv"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>User</o:Author>
  <o:LastAuthor>User</o:LastAuthor>
  <o:Revision>10</o:Revision>
  <o:TotalTime>112</o:TotalTime>
  <o:Created>2008-08-13T02:57:00Z</o:Created>
  <o:LastSaved>2008-08-13T05:09:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1187</o:Words>
  <o:Characters>6766</o:Characters>
  <o:Company>Microsoft</o:Company>
  <o:Lines>56</o:Lines>
  <o:Paragraphs>15</o:Paragraphs>
  <o:CharactersWithSpaces>7938</o:CharactersWithSpaces>
  <o:Version>11.6408</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><![if !supportAnnotations]>
<style id="dynCom" type="text/css"><!-- --></style>
<script language="JavaScript"><!--
function msoCommentShow(anchor_id, com_id)
{
	if(msoBrowserCheck()) 
		{
		c = document.all(com_id);
		a = document.all(anchor_id);
		if (null != c && null == c.length && null != a && null == a.length)
			{
			var cw = c.offsetWidth;
			var ch = c.offsetHeight;
			var aw = a.offsetWidth;
			var ah = a.offsetHeight;
			var x  = a.offsetLeft;
			var y  = a.offsetTop;
			var el = a;
			while (el.tagName != "BODY") 
				{
				el = el.offsetParent;
				x = x + el.offsetLeft;
				y = y + el.offsetTop;
				}
			var bw = document.body.clientWidth;
			var bh = document.body.clientHeight;
			var bsl = document.body.scrollLeft;
			var bst = document.body.scrollTop;
			if (x + cw + ah / 2 > bw + bsl && x + aw - ah / 2 - cw >= bsl ) 
				{ c.style.left = x + aw - ah / 2 - cw; }
			else 
				{ c.style.left = x + ah / 2; }
			if (y + ch + ah / 2 > bh + bst && y + ah / 2 - ch >= bst ) 
				{ c.style.top = y + ah / 2 - ch; }
			else 
				{ c.style.top = y + ah / 2; }
			c.style.visibility = "visible";
}	}	}
function msoCommentHide(com_id) 
{
	if(msoBrowserCheck())
		{
		c = document.all(com_id);
		if (null != c && null == c.length)
		{
		c.style.visibility = "hidden";
		c.style.left = -1000;
		c.style.top = -1000;
		} } 
}
function msoBrowserCheck()
{
	ms = navigator.appVersion.indexOf("MSIE");
	vers = navigator.appVersion.substring(ms + 5, ms + 6);
	ie4 = (ms > 0) && (parseInt(vers) >= 4);
	return ie4;
}
if (msoBrowserCheck())
{
	document.styleSheets.dynCom.addRule(".msocomanchor","background: infobackground");
	document.styleSheets.dynCom.addRule(".msocomoff","display: none");
	document.styleSheets.dynCom.addRule(".msocomtxt","visibility: hidden");
	document.styleSheets.dynCom.addRule(".msocomtxt","position: absolute");
	document.styleSheets.dynCom.addRule(".msocomtxt","top: -1000");
	document.styleSheets.dynCom.addRule(".msocomtxt","left: -1000");
	document.styleSheets.dynCom.addRule(".msocomtxt","width: 33%");
	document.styleSheets.dynCom.addRule(".msocomtxt","background: infobackground");
	document.styleSheets.dynCom.addRule(".msocomtxt","color: infotext");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-top: 1pt solid threedlightshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-right: 2pt solid threedshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-bottom: 2pt solid threedshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","border-left: 1pt solid threedlightshadow");
	document.styleSheets.dynCom.addRule(".msocomtxt","padding: 3pt 3pt 3pt 3pt");
	document.styleSheets.dynCom.addRule(".msocomtxt","z-index: 100");
}
// --></script>
<![endif]>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
h1
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	font-weight:bold;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-noshow:yes;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
span.MsoCommentReference
	{mso-style-noshow:yes;
	mso-ansi-font-size:10.5pt;
	mso-bidi-font-size:10.5pt;}
p
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-noshow:yes;
	mso-style-parent:批注文字;
	mso-style-next:批注文字;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:9.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.style1, li.style1, div.style1
	{mso-style-name:style1;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:27.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.style2, li.style2, div.style2
	{mso-style-name:style2;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	color:red;}
span.style21
	{mso-style-name:style21;
	color:red;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:普通表格;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
<meta http-equiv=Content-Language content=zh-cn>
<!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt'>

<div class=Section1>

<h1 align=center style='text-align:center; line-height:150%'>单片机串口通讯制作说明<span lang=EN-US
style='font-size:27.0pt'><o:p></o:p></span></h1>

<div class=MsoNormal align=center style='text-align:center'><span lang=EN-US>

<hr size=1 width=300 style='width:100%' noshade color=red>

</span>
</div>

<p align=center style='text-align:center; line-height:150%'><span class=style21><span lang=EN-US
style='font-size:13.5pt'>* </span><span
style='font-size:13.5pt'>该例程针对<span lang=EN-US>“TX<st1:chmetcnv UnitName="C"
SourceValue="1" HasSpace="False" Negative="True" NumberType="1" TCSC="0" w:st="on">-1C</st1:chmetcnv>”</span>型单片机实验板为例进行详解</span></span><span
style='font-size:13.5pt'> </span></p>

<p style="line-height: 150%"><span lang=EN-US style='font-size:10.0pt'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt'>我们举例采用比较传统的<span lang=EN-US>51</span>系列单片机为例，芯片选用<span
lang=EN-US>STC<st1:chmetcnv UnitName="C" SourceValue="89" HasSpace="False"
Negative="False" NumberType="1" TCSC="0" w:st="on">89C</st1:chmetcnv>52RC</span>，首先我们需要明确一点，目前高级语言没法编写单片机的驱动程序（即操作系统），<span
class=GramE>易语言</span>同样如此，但是高级语言可以编写上位机系统（控制单片机及其交互），可以获得单片机发送来的数据并且分析后发送指令，指导单片机完成一些控制工作，比如温度检测，发现温度过高可以通知单片机打开空调的电源（单片机控制继电器去工作，或者控制电机），这个过程中的数据传输可以采用串口、无线信号等都可以，下面我的举例主要是采用计算机和单片机之间串口通信，程序通过<span
class=GramE>易语言</span>编写的程序向单片机发送数据，单片机收到数据后，按照<span class=GramE>易语言</span>发送的数据控制单片机<span
lang=EN-US>P1</span>口分别点亮<span lang=EN-US>8</span>个发光二极管中的一部分，发送的二进制数据某位为<span
lang=EN-US>0</span>，则对应的发光二极管点亮，某位为<span lang=EN-US>1</span>，则对应的发光二极管关闭。</span></p>

<p style="line-height: 150%"><span style='font-size:18.0pt'>一、单片机部分的驱动程序编写</span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-indent:21.0pt; line-height:150%'><span style='font-size:10.0pt'>单片机程序可以采用<span lang=EN-US>C</span>语言或者汇编语言去编写，常用的编辑环境为<span
class=SpellE><span lang=EN-US>Keil</span></span>。</span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-indent:21.0pt; line-height:150%'><span class=SpellE><span lang=EN-US style='font-size:10.0pt'>Keil</span></span><span
lang=EN-US style='font-size:10.0pt'> C51 </span><span style='font-size:10.0pt'>软件是众多单片机应用开发的优秀软件之一，它集编辑，编译，仿真于一体，支持汇编<span
lang=EN-US>,PLM </span>语言和<span lang=EN-US> C </span>语言的程序设计，界面友好，易学易用。</span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-indent:21.0pt; line-height:150%'><span style='font-size:10.0pt'>下面介绍<span class=SpellE><span
lang=EN-US>Keil</span></span><span lang=EN-US> C51</span>软件的使用方法:</span></p>
<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
text-indent:21.0pt; line-height:150%'><span style='font-size:10.0pt'>进入<span lang=EN-US> <span
class=SpellE>Keil</span> C51 </span>后，屏幕如下图所示，几秒钟后出现编辑界面。</span></p>

<p class=MsoNormal align=center style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
auto;text-align:center; line-height:150%'><span lang=EN-US><img width=522 height=268
id="_x0000_i1026" src="images/image001.gif" border=0></span></p>

<p align=center style='text-align:center; line-height:150%'>　</p>

<p align=center style='text-align:center; line-height:150%'><span style='font-size:10.0pt'>启动<span
class=SpellE><span lang=EN-US>Keil</span></span><span lang=EN-US> C51</span>时的屏幕</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US><img width=763
height=472 id="_x0000_i1027" src="images/操作1.jpg" border=0></span></p>

<p align=center style='text-align:center; line-height:150%'><span style='font-size:10.0pt'>进入<span
class=SpellE><span lang=EN-US>Keil</span></span><span lang=EN-US> C51</span>后的编辑界面</span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　<b>简单程序的调试</b><span lang=EN-US><br>
</span>　学习程序设计语言、学习某种程序软件，最好的方法是直接操作实践。下面通过简单的编程、调试，引导大家学习<span class=SpellE><span
lang=EN-US>Keil</span></span><span lang=EN-US> C51</span>软件的基本使用方法和基本的调试技巧。</span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　<span lang=EN-US>1)</span>建立一个新工程<span
lang=EN-US><br>
</span>　单击<span lang=EN-US>“</span>工程<span lang=EN-US>”</span>菜单，在弹出的下拉菜单中选中<span
lang=EN-US>“</span>新建工程<span lang=EN-US>”</span>选项。</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=447 height=195 id="_x0000_i1028" src="images/操作2.gif"
border=0></span><span style='font-size:10.0pt'>　</span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　<span lang=EN-US>2)</span>然后选择你要保存的路径<span
lang=EN-US>,</span>输入工程文件的名字<span lang=EN-US>,</span>比如保存到<span lang=EN-US>C51</span>目录里<span
lang=EN-US>,</span>工程文件的名字为<span lang=EN-US>C51</span>，如下图所示<span lang=EN-US>,</span>然后点击保存。</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><br>
<img width=443 height=257 id="_x0000_i1029" src="images/操作3.jpg" border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　<span lang=EN-US>3)</span>这时会弹出一个对话框<span lang="en-us">，</span>要求你选择单片机的型号<span lang="en-us">，</span>你可以根据你使用的单片机来选择<span
lang=EN-US>，<span class=SpellE>keil</span> c51</span>几乎支持所有的<span lang=EN-US>51</span>核的单片机<span lang="en-us">，</span>我们现在采用的是<span lang=EN-US>STC<st1:chmetcnv UnitName="C"
SourceValue="89" HasSpace="False" Negative="False" NumberType="1" TCSC="0"
w:st="on">89C</st1:chmetcnv>52RC</span>，其中没有这个选项，因为互相兼容，可以选择<span class=SpellE><span
lang=EN-US>Atmel</span></span>的<st1:chmetcnv
UnitName="C" SourceValue="89" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on"><span lang=EN-US>89C</span></st1:chmetcnv><span lang=EN-US>52</span>来说明<span lang="en-us">，</span>如下图所示<span lang="en-us">，</span>选择<st1:chmetcnv UnitName="C"
SourceValue="89" HasSpace="False" Negative="False" NumberType="1" TCSC="0"
w:st="on"><span lang=EN-US>89C</span></st1:chmetcnv><span lang=EN-US>52</span>之后<span lang="en-us">，</span>右边栏是对这个单片机的基本的说明<span lang="en-us">，</span>然后点击确定<span lang="en-us">。</span></span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><br>
<img width=626 height=425 id="_x0000_i1030" src="images/操作4.jpg" border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　<span lang=EN-US>4)</span>完成上一步骤后，屏幕如下图所示
。</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=635 height=338 id="_x0000_i1031" src="images/操作5.jpg"
border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　到现在为止，我们还没有编写一句程序，下面开始编写程序。<span lang=EN-US><br>
</span>　<span lang=EN-US>5)</span>在下图中，单击<span lang=EN-US>“</span>文件<span
lang=EN-US>”</span>菜单，再在下拉菜单中单击<span lang=EN-US>“</span>新建<span lang=EN-US>”</span>选项
。</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=486 height=145 id="_x0000_i1032" src="images/操作6.gif"
border=0></span><span style='font-size:10.0pt'>　 　</span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　新建文件后屏幕如下图所示。</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=635 height=338 id="_x0000_i1033" src="images/操作7.jpg"
border=0>&nbsp;</span></p>

<p style='text-indent:21.0pt; line-height:150%'><span style='font-size:10.0pt'>此时光标在编辑窗口里闪烁，这时可以键入用户的应用程序了，但建议首先保存该空白的文件，单击菜单上的<span
lang=EN-US>“</span>文件<span lang=EN-US>”</span>，在下拉菜单中选中<span lang=EN-US>“</span>另存为<span
lang=EN-US>”</span>选项单击，屏幕如下图所示，在<span lang=EN-US>“</span>文件名<span lang=EN-US>”</span>栏右侧的编辑框中，键入欲使用的文件名，同时，必须键入正确的扩展名。注意，如果用Ｃ语言编写程序，则扩展名为<span
lang=EN-US>(.c)</span>；如果用汇编语言编写程序，则扩展名必须为<span lang=EN-US>(.<span
class=SpellE>asm</span>)</span>，然后，单击<span lang=EN-US>“</span>保存<span
lang=EN-US>”</span>按钮。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'>&nbsp;</span><span lang=EN-US><img width=443
height=257 id="_x0000_i1034" src="images/使用8.jpg" border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　<span lang=EN-US>6)</span>回到编辑界面后，单击<span
lang=EN-US>“Target 1”</span>前面的<span lang=EN-US>“</span>＋<span lang=EN-US>”</span>号，然后在<span
lang=EN-US>“Source Group <st1:chmetcnv UnitName="”" SourceValue="1"
HasSpace="False" Negative="False" NumberType="1" TCSC="0" w:st="on">1”</st1:chmetcnv></span>上单击右键，弹出如下菜单
。
</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=436 height=391 id="_x0000_i1035" src="images/使用9.jpg"
border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　然后单击<span lang=EN-US>“</span>增加文件到组<span
lang=EN-US> ‘Source Group 1’” </span>屏幕如下图所示。 </span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=441 height=271 id="_x0000_i1036" src="images/使用10.jpg"
border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　选中 串口<span lang=EN-US>.c</span>，然后单击<span
lang=EN-US>“Add&nbsp;”</span>屏幕好下图所示。 </span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=578 height=289 id="_x0000_i1037" src="images/使用11.jpg"
border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　注意到<span lang=EN-US>“Source Group <st1:chmetcnv
UnitName="”" SourceValue="1" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on">1”</st1:chmetcnv></span>文件夹中多了一个子项<span lang=EN-US>“</span>串口<span
lang=EN-US>.c”</span>了吗？子项的多少与所增加的源程序的多少相同。 </span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=635 height=338 id="_x0000_i1038" src="images/使用12.jpg"
border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　<span lang=EN-US>7)</span>现在，请输入如下的<span
lang=EN-US>C</span>语言源程序<span lang=EN-US>: </span></span></p>

<p style="line-height: 150%"><span lang=EN-US style='font-size:10.0pt'>#include &lt;reg52.h&gt; //</span><span
style='font-size:10.0pt'>包含单片机操作头文件<span lang=EN-US><br>
unsigned char <span class=SpellE>flag,tmp</span>;//</span>定义变量<span lang=EN-US><br>
void main()<br>
{<br>
REN=1;<br>
TMOD=0x20;//</span>定时器工作方式<span lang=EN-US><br>
TH1=0xfd;//</span>设置串行口波特率<span lang=EN-US>9600<br>
TL1=0xfd;//</span>设置串行口波特率<span lang=EN-US>9600<br>
TR1=1;//</span>启动计时器<span lang=EN-US>1(</span>启动串行口<span lang=EN-US>)<br>
SM0=0;<br>
SM1=1;<br>
EA=1;////CPU</span>开中断<span lang=EN-US><br>
ES=1;////CPU</span>开中断<span lang=EN-US><br>
while(1)//</span>设置一个循环<span lang=EN-US><br>
{<br>
if(flag==1)//</span>代表收到了数据<span lang=EN-US><br>
{<br>
ES=0;<br>
flag=0;<br>
P1=<span class=SpellE>tmp</span>;//</span>点亮发光二极管<span lang=EN-US><br>
SBUF=<span class=SpellE>tmp</span>;//</span><span class=GramE>把值重新</span>写入缓冲区，相当于从串口发送数据，电脑就可以接收到数据<span
lang=EN-US><br>
while(!TI);<br>
TI=0;<br>
ES=1;<br>
}<br>
}<br>
}<br>
<br>
void ser() interrupt 4 //</span>中断，等待数据到来触发<span lang=EN-US><br>
{<br>
RI=0;<br>
<span class=SpellE>tmp</span>=SBUF;//</span>取得数据到变量<span lang=EN-US><br>
flag=1;<br>
}<br>
</span>　</span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　在输入上述程序时，读者已经看到了事先保存待编辑的文件的好处了吧，即<span
class=SpellE><span lang=EN-US>Keil</span></span><span lang=EN-US> c51</span>会自动识别关键字，并以不同的颜色提示用户加以注意，这样会使用户少犯错误，有利于提高编程效率。程序输入完毕后，如下图所示
</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=792 height=561 id="_x0000_i1039" src="images/使用13.jpg"
border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　<span lang=EN-US>8)</span>在上图中，单击<span
lang=EN-US>“</span>工程<span lang=EN-US>”</span>菜单，再在下拉菜单中单击<span lang=EN-US>“</span>目标<span
lang=EN-US>'Target1' </span>属性<span lang=EN-US>”</span>选项，屏幕如下所示。</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=636 height=329 id="_x0000_i1040" src="images/使用14.gif"
border=0></span></p>

<p style="line-height: 150%"><span style='font-size:10.0pt'>　<span lang=EN-US>9)</span>在弹出窗口中，切换到输出选择夹，选中<span
lang=EN-US>“</span>生成<span lang=EN-US> HEX </span>文件<span lang=EN-US>”</span>，因为单片机烧录中需要<span
lang=EN-US>hex</span>文件或者<span lang=EN-US>bin</span>文件。</span></p>

<p align=center style='text-align:center; line-height:150%'><span lang=EN-US style='font-size:
10.0pt'><img width=626 height=425 id="_x0000_i1041" src="images/使用15.jpg"
border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt;
color:black'>10</span><span style='font-size:10.0pt;color:black'>）</span><span
style='font-size:10.0pt'>单击<span lang=EN-US>“</span>工程<span lang=EN-US>”</span>菜单，再在下拉菜单中单击<span
lang=EN-US>“</span>重新构造所有目标<span lang=EN-US>”</span>，显示如下图。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=618 height=439 id="_x0000_i1042"
src="images/使用16.gif" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>11</span><span
style='font-size:10.0pt'>）编译后显示如下的调试信息，可以看到已经产生了<span lang=EN-US>hex</span>文件。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=792 height=561 id="_x0000_i1043"
src="images/使用17.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>12</span><span
style='font-size:10.0pt'>）<span lang=EN-US>hex</span>文件在如下图的位置显示，下面就可以使用工具将生成的文件写入单片机了。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=872 height=306 id="_x0000_i1044"
src="images/使用18.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>13</span><span
style='font-size:10.0pt'>）<span lang=EN-US>STC</span>系列的单片机程序下载工具如下图，<a
style='mso-comment-reference:U_1;mso-comment-date:20080813T1129'>双击</a></span><span
style='font-size:10.0pt'><span
class=GramE><span style='mso-comment-continuation:1'>运行</span></span></span><span
style='font-size:10.0pt'><a
style='mso-comment-reference:U_1;mso-comment-date:20080813T1129'>选中的下载程序</a><span
class=GramE><span style='mso-comment-continuation:1'>主</span></span><span
style='mso-comment-continuation:1'>文件。</span></span></p>

<p style='text-indent:21.0pt; line-height:150%'>　</p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US><img
width=763 height=472 id="_x0000_i1045" src="images/操作1.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>14</span><span
style='font-size:10.0pt'>）选择单片机类型<span lang=EN-US>STC<st1:chmetcnv UnitName="C"
SourceValue="89" HasSpace="False" Negative="False" NumberType="1" TCSC="0"
w:st="on">89C</st1:chmetcnv>52RC</span>，然后点击<span lang=EN-US> &quot;Open
File&quot; </span>按钮打开文件，如下图。</span></p>

<p style='text-indent:21.0pt; line-height:150%'>　</p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=781 height=584 id="_x0000_i1046"
src="images/使用20.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>15</span><span
style='font-size:10.0pt'>）然后需要先确定关闭单片机电源，因为我们采用的单片机需要冷启动，之后点击<span lang=EN-US>“Download/</span>下载<span
lang=EN-US>”</span>按钮，如下图。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=801 height=603 id="_x0000_i1047"
src="images/使用21.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>16</span><span
style='font-size:10.0pt'>）然后打开单片机电源，程序开始下载，下载<span class=GramE>后如下</span>图，到这里，单片机部分程序编写结束，之后我们将进入控制端即<span
class=GramE>易语言</span>程序的编写。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=801 height=603 id="_x0000_i1048"
src="images/使用22.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span style='font-size:18.0pt'>二、<span
class=GramE>易语言</span>程序编写</span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>1</span><span
style='font-size:10.0pt'>）<span class=GramE>易语言</span>和单片机通信，我们采用串口方式，在<span
class=GramE>易语言</span>中，我们选择端口组件，如下图鼠标按下并且显示提示的组件。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=161 height=335 id="_x0000_i1049"
src="images/使用29.gif" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>2</span><span
style='font-size:10.0pt'>）之后我们设计一个需要的界面，界面中我们计划发送两个数据序列，分别为<span lang=EN-US>10101010</span>和<span
lang=EN-US>01010101</span>，用来控制单片机上的<span lang=EN-US>8</span>个发光二极管的发光和关闭（因为在单片机中，通过给对应的管脚发送<span
lang=EN-US>0</span>和<span lang=EN-US>1</span>来控制高低电平，也就可以控制线路的通断，达到控制的效果），同时我们希望用程序来模拟显示出当前发光二极管的工作状态，于是我们在程序动态生成了<span
lang=EN-US>8</span>个标签，分别代表<span lang=EN-US>8</span>个发光二极管，在我们的程序中，发送数据到单片机，我们让单片机把收到的数据完整地返回给计算机，这样计算机收到的数据和单片机收到的数据一致，就可以完全仿真出当前单片机的工作状态，我们规定标签背景为红色代表对应的发光二极管发光，界面上放置有端口组件和两对编辑框和发送按钮以及模拟标签，端口组件的属性设置可以保持默认，即端口号为<span
lang=EN-US>1</span>，波特率为<span lang=EN-US>9600</span>，这些设置需要根据计算机的硬件控制，比如串口线连接在那个串口上了，默认连接在计算机的第一个串口上则设置为<span
lang=EN-US>1</span>，波特率的设置需要根据单片机的晶振计算，同时单片机代码和计算机的代码中波特率设置要一致，本例中统<span
class=GramE>一</span>设置为<span lang=EN-US>9600</span>，设计如下的界面。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=403 height=268 id="_x0000_i1050"
src="images/使用30.jpg" border=0></span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'>　</p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>3</span><span
style='font-size:10.0pt'>）通过如下代码，可以生成<span lang=EN-US>8</span>个模拟标签。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=553 height=240 id="_x0000_i1051"
src="images/使用27.gif" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>4</span><span
style='font-size:10.0pt'>）运行后，生成标签如下图。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=380 height=250 id="_x0000_i1052"
src="images/使用28.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>5</span><span
style='font-size:10.0pt'>）下面我们就要编写发送数据的代码，代码如下，分别通过两个按钮发送两个整数<span lang=EN-US>170</span>和<span
lang=EN-US>85</span>，因为<span lang=EN-US>170</span>对应的二进制为<span lang=EN-US>10101010</span>，<span
lang=EN-US>85</span>对应为<span lang=EN-US>01010101</span>，<span class=GramE>易语言</span>发送数据无法直接发送二进制，所以发送对应的<span
class=GramE>十进制数据即可</span>，发送代码如下。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=537 height=231 id="_x0000_i1053"
src="images/使用25.gif" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>6</span><span
style='font-size:10.0pt'>）现在我们其实已经可以运行程序，通过点击两个按钮发送数据，可以看到单片机上的发光二极管有点亮的过程，如图。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=825 height=539 id="_x0000_i1054"
src="images/使用31.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>7</span><span
style='font-size:10.0pt'>）此时虽然已经可以发送数据，但是计算机程序还没有编写接收数据及其仿真显示，下面我们需要编写如下代码以实现数据接收和模拟显示，代码大家自行分析即可，其中用到了一个进制转换模块，模块是<span
class=GramE>易语言</span>自带的，目的是把收到的十进制数据转换为二进制便于模拟显示之用。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=903 height=424 id="_x0000_i1055"
src="images/使用26.gif" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>8</span><span
style='font-size:10.0pt'>）之后我们再次运行程序，就可以看到数据接收的调试输出结果和模拟仿真的结果了，发送<span
lang=EN-US>170</span>和<span lang=EN-US>85</span>之后的结果显示分别在下图有所体现。</span></p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=715 height=472 id="_x0000_i1056"
src="images/使用23.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'>　</p>

<p align=center style='text-align:center;text-indent:21.0pt; line-height:150%'><span lang=EN-US
style='font-size:10.0pt'><img width=721 height=473 id="_x0000_i1057"
src="images/使用24.jpg" border=0></span></p>

<p style='text-indent:21.0pt; line-height:150%'><span lang=EN-US style='font-size:10.0pt'>9</span><span
style='font-size:10.0pt'>）至此我们的程序和演示编写完毕，大家可以在此基础上继续利用单片机试验板上的资源充分练习其他功能，但是计算机和单片机的通信过程也就不外乎上面的办法，只是需要自己制定一些控制规则，可以控制单片机上的数码管、继电器、<span
lang=EN-US>USB</span>芯片等。</span></p>

<p style="line-height: 150%"><span lang=EN-US style='font-size:10.0pt'><br>
</span><span style='font-size:10.0pt'>　</span></p>

<div class=MsoNormal align=center style='text-align:center'><span lang=EN-US>

<hr size=2 width="100%" align=center>

</span></div>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:0cm;mso-padding-alt:0cm 0cm 0cm 0cm'
 id=table1>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width="100%" style='width:100.0%;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=center style='text-align:center; line-height:150%'>版权所有<span
  lang=EN-US>&nbsp;&nbsp; </span>大连<span class=GramE>大有吴涛易语言</span>软件开发有限公司<span
  lang=EN-US>&nbsp;&nbsp; </span>电话<span lang=EN-US>:86-0411-88995831&nbsp;&nbsp;
  </span>传真<span lang=EN-US>:86-0411-88995834</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style="line-height: 150%"><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

<div style='mso-element:comment-list'><![if !supportAnnotations]>

<hr class=msocomoff align=left size=1 width="33%">

<![endif]>

<div style='mso-element:comment'><![if !supportAnnotations]>

<div id="_com_1" class=msocomtxt language=JavaScript
onmouseover="msoCommentShow('_anchor_1','_com_1')"
onmouseout="msoCommentHide('_com_1')"><![endif]><span style='mso-comment-author:
User'><![if !supportAnnotations]><a name="_msocom_1"></a><![endif]></span>

<p class=MsoCommentText style="line-height: 150%">　</p>

<![if !supportAnnotations]></div>

<![endif]></div>

</div>

</body>

</html>
